@model IndexModel
@inject IStorageInfo Storage
@inject IGlobalInfo Global2

<div class="mt-4 mb-4">
    <div class="jumbotron mb-0" style="background-color: #f4f5f7; padding-top: 30px; padding-bottom: 30px">
        <div class="row align-middle" style="margin-left: 1px">
            <h3>Jet<span style="font-weight: 200">Hub</span></h3>@Global.Version
        </div>
        <p>
            <small>
                Uptime: <i class="fas fa-circle" style="color: #26C281; font-size: x-small; margin-right: 2px"></i>@(Model.Uptime)
                |
                Load average: @Model.LoadAverage
            </small>
        </p>

        <h6 style="font-weight: 400" class="mb-2">
            Hub Version
            <small style="color: #42526e">
                <i class="fas fa-fingerprint fa-fw"></i> <span id="hub-commitid" title="Commit ID"><a href="https://github.com/namofun/jethub/tree/@Global.CommitId" class="text-reset">@Global.CommitId[0..7]</a></span>
                <i class="fas fa-code-branch fa-fw"></i> <span id="hub-branch" title="Branch: @Global.Branch">@Global.Branch</span>
            </small>
        </h6>

        <h6 style="font-weight: 400" class="mb-0">
            Judgehost Version
            <small style="color: #42526e">
                <i class="fas fa-fingerprint fa-fw"></i> <span id="latest-commitid" title="Commit ID"><a href="https://github.com/namofun/judgehost/tree/@Model.JudgehostCommitId" class="text-reset">@Model.JudgehostCommitId[0..7]</a></span>
                <i class="fas fa-code-branch fa-fw"></i> <span id="latest-branch" title="Branch: @Model.JudgehostBranch">@Model.JudgehostBranch</span>
            </small>
        </h6>
    </div>
</div>

<div class="row">
    <div class="col-lg-4">
        <div class="card border-0 p-4 mb-3" style="background-color: #f4f5f7;">
            <h6 class="font-weight-normal mb-3"><i class="fas fa-microchip"></i>&nbsp;Processor status</h6>
            @foreach (var proc in Global2.CpuInfo)
            {
                <p class="mb-2"><i class="fas fa-circle @(proc.Core < proc.Processor ? "text-warning" : "text-success")" title="@(proc.Core < proc.Processor ? $"{proc.Core} core and {proc.Processor} threads. Seems that hyper-threading is open, may lead to inaccurate results when judging float-calculation problems." : $"{proc.Core} core and {proc.Processor} threads. Seems that hyper-threading is disabled, which is good.")" style="font-size: x-small; margin-right: 2px"></i> [@(proc.Core)/@(proc.Processor)] @proc.CpuName</p>
            }
            @foreach (var jh in Model.Judgehosts)
            {
                <p class="mb-2"><i class="fas fa-circle" style="color: #26C281; font-size: x-small; margin-right: 2px"></i> @jh</p>
            }
        </div>
    </div>
    <div class="col-lg-4">
        <div class="card border-0 p-4 mb-3" style="background-color: #f4f5f7;">
            <h6 class="font-weight-normal mb-3"><i class="fas fa-memory"></i>&nbsp;Storage status</h6>
            <p class="mb-1"><i class="fas fa-circle text-success" style="color: #26C281; font-size: x-small; margin-right: 2px"></i> Memory: @((int)Storage.Memory.Used)MB / @((int)Storage.Memory.Total)MB</p>
            <div class="progress mb-3">
                <div class="progress-bar" role="progressbar" style="width: @(Storage.Memory.Used * 100 / Storage.Memory.Total)%" aria-valuenow="@(Storage.Memory.Used * 100 / Storage.Memory.Total)" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <p class="mb-1"><i class="fas fa-circle text-success" style="font-size: x-small; margin-right: 2px"></i> Swap: @((int)Storage.Swap.Used)MB / @((int)Storage.Swap.Total)MB</p>
            <div class="progress mb-3">
                <div class="progress-bar" role="progressbar" style="width: @(Storage.Swap.Used * 100 / Storage.Swap.Total)%" aria-valuenow="@(Storage.Swap.Used * 100 / Storage.Swap.Total)" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            @foreach (var hdd in Storage.HardDrive)
            {
                <p class="mb-1"><i class="fas fa-circle @(hdd.Value.Used + 2 < hdd.Value.Total ? "text-success" : hdd.Value.Used + 1 < hdd.Value.Total ? "text-warning" : "text-danger")" style="font-size: x-small; margin-right: 2px"></i> <span title="Mounted at @hdd.Value.Type">@hdd.Key</span>: @(hdd.Value.Used.ToString("F2"))GB / @(hdd.Value.Total.ToString("F2"))GB</p>
                <div class="progress mb-3">
                    <div class="progress-bar" role="progressbar" style="width: @(hdd.Value.Used * 100 / hdd.Value.Total)%" aria-valuenow="@(hdd.Value.Used * 100 / hdd.Value.Total)" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            }
        </div>
    </div>
    <div class="col-lg-4">
        <div class="card border-0 p-4 mb-3" style="background-color: #f4f5f7;">
            <h6 class="font-weight-normal mb-3"><i class="fab fa-ubuntu"></i>&nbsp;Kernel status</h6>
            <p class="mb-2"><i class="fas fa-circle text-primary" style="font-size: x-small; margin-right: 2px"></i> Kernel Version: <small>@Global2.KernelVersion</small></p>
            <p class="mb-2"><i class="fas fa-circle @(Global2.BootCmdline.Contains("cgroup_enable=memory") && Global2.BootCmdline.Contains("swapaccount=1") ? "text-success" : "text-danger")" style="font-size: x-small; margin-right: 2px"></i> Boot Cmdline: <small>@Global2.BootCmdline</small></p>
        </div>
    </div>
</div>
